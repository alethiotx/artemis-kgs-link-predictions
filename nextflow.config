
/*
 * Nextflow Configuration
 * ====================================
 * 
 * Configuration file for the knowledge graph-based target prediction pipeline.
 * Defines global parameters, process settings, and dataset-specific profiles.
 * 
 * Usage:
 *   nextflow run main.nf -profile hetionet --dataset hetionet --model path/to/model
 *   nextflow run main.nf -profile biokg --dataset biokg --model path/to/model --sample false
 * 
 * Required parameters:
 *   --dataset: Dataset name (hetionet, biokg, openbiolink, primekg)
 *   --model: Path to trained prediction model
 * 
 * Optional parameters:
 *   --outdir: Output directory (default: S3 bucket)
 *   --env: Environment mode (prod or test)
 *   --sample: Whether to downsample terms (true or false)
 */

// ============================================================================
// Global Parameters
// ============================================================================

// Dataset to process (required)
// Options: 'hetionet', 'biokg', 'openbiolink', 'primekg'
params.dataset = null

// Path to trained prediction model (required)
// Can be local path or S3 URI
params.model = null

// Output directory for results
// Default: S3 bucket for production storage
params.outdir = 's3://alethiotx-artemis/data/kgs/associations/'

// Environment mode
// 'prod': Full production run
// 'test': Limited run with only 2 terms for validation
params.env = 'prod'

// Downsample terms to 10,000 for faster processing
// Set to false to process all terms
params.sample = true

// ============================================================================
// Process Configuration
// ============================================================================

process {
    // Docker container with PyKEEN and all required dependencies
    // Source: artemis-kgs-embeddings repo
    // https://github.com/alethiotx/artemis-kgs-embeddings
    container = 'public.ecr.aws/alethiotx/artemis-kgs-embeddings:latest'
}

// ============================================================================
// Execution Profiles
// ============================================================================

profiles {
    /*
     * Local Profile
     * -------------
     * For local development and testing without cloud resources.
     */
    local {
        includeConfig 'conf/base.config'
        includeConfig 'conf/local.config'
    }

    /*
     * Hetionet Profile
     * ----------------
     * Hetionet: A network of biology and disease knowledge
     * Integrates 47,031 nodes (11 types) and 2,250,197 relationships (24 types)
     */
    hetionet {
        includeConfig 'conf/base.config'
        includeConfig 'conf/hetionet.config'
    }

    /*
     * BioKG Profile
     * -------------
     * BioKG: Comprehensive biomedical knowledge graph
     * Focuses on proteins, diseases, drugs, and pathways
     */
    biokg {
        includeConfig 'conf/base.config'
        includeConfig 'conf/biokg.config'
    }

    /*
     * OpenBioLink Profile
     * -------------------
     * OpenBioLink: Large-scale open biomedical knowledge graph
     * Contains gene, disease, and phenotype associations
     */
    openbiolink {
        includeConfig 'conf/base.config'
        includeConfig 'conf/openbiolink.config'
    }

    /*
     * PrimeKG Profile
     * ---------------
     * PrimeKG: Precision Medicine Knowledge Graph
     * Integrates 20+ biomedical resources with focus on drug discovery
     */
    primekg {
        includeConfig 'conf/base.config'
        includeConfig 'conf/primekg.config'
    }
}
